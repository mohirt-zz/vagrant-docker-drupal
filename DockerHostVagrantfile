# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(2) do |config|
  config.vm.define "PROJECT_CODE_dockerhost" do |d|
    d.vm.box = "ubuntu/trusty64"
    d.vm.provision "docker"

    d.vm.hostname = "PROJECT_CODE-dockerhost"
    d.vm.network "private_network", ip: "DOCKER_HOST_IP"

    d.vm.synced_folder '.', '/vagrant', type: "nfs"

    d.vm.provider "virtualbox" do |vb|
      # You may change the cpus and memory.
      vb.cpus = 4
      vb.memory = "2048"
    end

$script = <<SCRIPT
ps aux | grep 'sshd:' | awk '{print $2}' | xargs kill
echo 'DOCKER_OPTS="--dns 8.8.8.8 --dns 8.8.4.4 --iptables=true --icc=false"' >> /etc/default/docker
service docker restart
SCRIPT

    d.vm.provision "shell", inline: $script
  end

end
